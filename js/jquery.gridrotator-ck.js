/**
 * jquery.gridrotator.js v1.1.0
 * http://www.codrops.com
 *
 * Licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 * 
 * Copyright 2012, Codrops
 * http://www.codrops.com
 */(function(e,t,n){"use strict";function o(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}function u(){var e=o();return e?document[e]:!1}function a(e){return Object.keys(e).length===0}var r=e.event,i,s;i=r.special.debouncedresize={setup:function(){e(this).on("resize",i.handler)},teardown:function(){e(this).off("resize",i.handler)},handler:function(e,t){var n=this,o=arguments,u=function(){e.type="debouncedresize";r.dispatch.apply(n,o)};s&&clearTimeout(s);t?u():s=setTimeout(u,i.threshold)},threshold:100};Array.prototype.shuffle=function(){var e=this.length,t,n;while(e--){t=Math.floor(Math.random()*e);n=this[e];this[e]=this[t];this[t]=n}return this};var f=e(t),l=t.Modernizr;e.GridRotator=function(t,n){this.$el=e(n);if(l.backgroundsize){var r=this;this.$el.addClass("ri-grid-loading");this._init(t)}};e.GridRotator.defaults={rows:3,columns:14,w1024:{rows:3,columns:8},w768:{rows:3,columns:7},w480:{rows:3,columns:5},w320:{rows:2,columns:4},w240:{rows:2,columns:3},step:"random",maxStep:3,preventClick:!0,animType:"random",animSpeed:800,animEasingOut:"linear",animEasingIn:"linear",interval:3e3,slideshow:!0,onhover:!1,nochange:[]};e.GridRotator.prototype={_init:function(t){this.options=e.extend(!0,{},e.GridRotator.defaults,t);this._config()},_config:function(){var t=this,n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.supportTransitions=l.csstransitions;this.supportTransforms3D=l.csstransforms3d;this.transEndEventName=n[l.prefixed("transition")]+".gridrotator";this.animTypes=this.supportTransforms3D?["fadeInOut","slideLeft","slideRight","slideTop","slideBottom","rotateLeft","rotateRight","rotateTop","rotateBottom","scale","rotate3d","rotateLeftScale","rotateRightScale","rotateTopScale","rotateBottomScale"]:["fadeInOut","slideLeft","slideRight","slideTop","slideBottom"];this.animType=this.options.animType;this.animType!=="random"&&!this.supportTransforms3D&&e.inArray(this.animType,this.animTypes)===-1&&this.animType!=="showHide"&&(this.animType="fadeInOut");this.animTypesTotal=this.animTypes.length;this.$list=this.$el.children("ul");var r=0,i=this.$list.find("img"),s=i.length;i.each(function(){var n=e(this),o=n.attr("src");e("<img/>").load(function(){++r;n.parent().css("background-image","url("+o+")");if(r===s){i.remove();t.$el.removeClass("ri-grid-loading");t.$items=t.$list.children("li");t.$itemsCache=t.$items.clone();t.itemsTotal=t.$items.length;t.outItems=[];t._layout(function(){t._initEvents()});t._start()}}).attr("src",o)})},_layout:function(t){var n=this;this._setGridDim();this.$list.empty();this.$items=this.$itemsCache.clone().appendTo(this.$list);var r=this.$items.filter(":gt("+(this.showTotal-1)+")"),i=r.children("a");this.outItems.length=0;i.each(function(t){n.outItems.push(e(this))});r.remove();var s=document.defaultView?parseInt(document.defaultView.getComputedStyle(this.$el.get(0),null).width):this.$el.width(),o=Math.floor(s/this.columns),u=s-this.columns*Math.floor(o);for(var a=0;a<this.rows;++a)for(var f=0;f<this.columns;++f){var l=this.columns*a+f,c=this.$items.eq(l);c.css({width:f<Math.floor(u)?o+1:o,height:o});e.inArray(l,this.options.nochange)!==-1&&c.addClass("ri-nochange").data("nochange",!0)}this.options.preventClick&&this.$items.children().css("cursor","default").on("click.gridrotator",!1);t&&t.call()},_setGridDim:function(){var e=this.$el.width();switch(!0){case e<240:this.rows=this.options.w240.rows;this.columns=this.options.w240.columns;break;case e<320:this.rows=this.options.w320.rows;this.columns=this.options.w320.columns;break;case e<480:this.rows=this.options.w480.rows;this.columns=this.options.w480.columns;break;case e<768:this.rows=this.options.w768.rows;this.columns=this.options.w768.columns;break;case e<1024:this.rows=this.options.w1024.rows;this.columns=this.options.w1024.columns;break;default:this.rows=this.options.rows;this.columns=this.options.columns}this.showTotal=this.rows*this.columns},_initEvents:function(){var t=this;f.on("debouncedresize.gridrotator",function(){t._layout()});var n=o();if(n){var r=n.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(r,function(){t._visChange()})}!l.touch&&this.options.onhover&&t.$items.on("mouseenter.gridrotator",function(){var n=e(this);if(!n.data("active")&&!n.data("hovered")&&!n.data("nochange")){n.data("hovered",!0);t._replace(n)}}).on("mouseleave.gridrotator",function(){e(this).data("hovered",!1)})},_visChange:function(){u()?clearTimeout(this.playtimeout):this._start()},_start:function(){this.showTotal<this.itemsTotal&&this.options.slideshow&&this._showNext()},_getAnimType:function(){return this.animType==="random"?this.animTypes[Math.floor(Math.random()*this.animTypesTotal)]:this.animType},_getAnimProperties:function(e){var t={},r={},i={},s={},o=this._getAnimType(),u,a=0;switch(o){case"showHide":u=0;s.opacity=0;break;case"fadeInOut":s.opacity=0;break;case"slideLeft":t.left=e.width();i.left=0;s.left=-e.width();break;case"slideRight":t.left=-e.width();i.left=0;s.left=e.width();break;case"slideTop":t.top=e.height();i.top=0;s.top=-e.height();break;case"slideBottom":t.top=-e.height();i.top=0;s.top=e.height();break;case"rotateLeft":u=this.options.animSpeed/2;t.transform="rotateY(90deg)";i.transform="rotateY(0deg)";a=u;s.transform="rotateY(-90deg)";break;case"rotateRight":u=this.options.animSpeed/2;t.transform="rotateY(-90deg)";i.transform="rotateY(0deg)";a=u;s.transform="rotateY(90deg)";break;case"rotateTop":u=this.options.animSpeed/2;t.transform="rotateX(90deg)";i.transform="rotateX(0deg)";a=u;s.transform="rotateX(-90deg)";break;case"rotateBottom":u=this.options.animSpeed/2;t.transform="rotateX(-90deg)";i.transform="rotateX(0deg)";a=u;s.transform="rotateX(90deg)";break;case"scale":u=this.options.animSpeed/2;t.transform="scale(0)";r.transform="scale(1)";i.transform="scale(1)";a=u;s.transform="scale(0)";break;case"rotateLeftScale":r.transform="scale(1)";u=this.options.animSpeed/2;t.transform="scale(0.3) rotateY(90deg)";i.transform="scale(1) rotateY(0deg)";a=u;s.transform="scale(0.3) rotateY(-90deg)";break;case"rotateRightScale":r.transform="scale(1)";u=this.options.animSpeed/2;t.transform="scale(0.3) rotateY(-90deg)";i.transform="scale(1) rotateY(0deg)";a=u;s.transform="scale(0.3) rotateY(90deg)";break;case"rotateTopScale":r.transform="scale(1)";u=this.options.animSpeed/2;t.transform="scale(0.3) rotateX(90deg)";i.transform="scale(1) rotateX(0deg)";a=u;s.transform="scale(0.3) rotateX(-90deg)";break;case"rotateBottomScale":r.transform="scale(1)";u=this.options.animSpeed/2;t.transform="scale(0.3) rotateX(-90deg)";i.transform="scale(1) rotateX(0deg)";a=u;s.transform="scale(0.3) rotateX(90deg)";break;case"rotate3d":u=this.options.animSpeed/2;t.transform="rotate3d( 1, 1, 0, 90deg )";i.transform="rotate3d( 1, 1, 0, 0deg )";a=u;s.transform="rotate3d( 1, 1, 0, -90deg )"}return{startInProp:t,startOutProp:r,endInProp:i,endOutProp:s,delay:a,animSpeed:u!=n?u:this.options.animSpeed}},_showNext:function(e){var t=this;clearTimeout(this.playtimeout);this.playtimeout=setTimeout(function(){var e=t.options.step,n=t.options.maxStep,r=1;n>t.showTotal&&(n=t.showTotal);var i=e==="random"?Math.floor(Math.random()*n+r):Math.min(Math.abs(e),n),s=t._getRandom(i,t.showTotal);for(var o=0;o<i;++o){var u=t.$items.eq(s[o]);if(u.data("active")||u.data("nochange")){t._showNext(1);return!1}t._replace(u)}t._showNext()},e||Math.max(Math.abs(this.options.interval),300))},_replace:function(t){t.data("active",!0);var n=this,r=t.children("a:last"),i={width:r.width(),height:r.height()};t.data("active",!0);var s=this.outItems.shift();this.outItems.push(r.clone().css("transition","none"));s.css(i).prependTo(t);var o=this._getAnimProperties(r);s.css(o.startInProp);r.css(o.startOutProp);this._setTransition(s,"all",o.animSpeed,o.delay,this.options.animEasingIn);this._setTransition(r,"all",o.animSpeed,0,this.options.animEasingOut);this._applyTransition(s,o.endInProp,o.animSpeed,function(){var t=e(this),r=o.animSpeed===n.options.animSpeed&&a(o.endInProp)?o.animSpeed:0;setTimeout(function(){n.supportTransitions&&t.off(n.transEndEventName);t.next().remove();t.parent().data("active",!1)},r)},o.animSpeed===0||a(o.endInProp));this._applyTransition(r,o.endOutProp,o.animSpeed)},_getRandom:function(e,t){var n=[];for(var r=0;r<t;++r)n.push(r);return n.shuffle().slice(0,e)},_setTransition:function(e,t,n,r,i){setTimeout(function(){e.css("transition",t+" "+n+"ms "+r+"ms "+i)},25)},_applyTransition:function(t,n,r,i,s){var o=this;setTimeout(function(){e.fn.applyStyle=o.supportTransitions?e.fn.css:e.fn.animate;if(i&&o.supportTransitions){t.on(o.transEndEventName,i);s&&i.call(t)}i=i||function(){return!1};t.stop().applyStyle(n,e.extend(!0,[],{duration:r+"ms",complete:i}))},25)}};var c=function(e){t.console&&t.console.error(e)};e.fn.gridrotator=function(t){var n=e.data(this,"gridrotator");if(typeof t=="string"){var r=Array.prototype.slice.call(arguments,1);this.each(function(){if(!n){c("cannot call methods on gridrotator prior to initialization; attempted to call method '"+t+"'");return}if(!e.isFunction(n[t])||t.charAt(0)==="_"){c("no such method '"+t+"' for gridrotator instance");return}n[t].apply(n,r)})}else this.each(function(){n?n._init():n=e.data(this,"gridrotator",new e.GridRotator(t,this))});return n}})(jQuery,window);